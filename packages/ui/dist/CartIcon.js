import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { ShoppingCart, X, Trash2, Plus, Minus } from 'lucide-react';
import { useCart } from '@zoroaster/shared';
import { useNavigate } from 'react-router-dom';
export const CartIcon = () => {
    const { state, removeItem, updateQuantity, clearCart } = useCart();
    const [isOpen, setIsOpen] = useState(false);
    const navigate = useNavigate();
    const formatPrice = (amount, currency) => {
        return new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: currency.toUpperCase(),
        }).format(amount);
    };
    const handleCheckout = () => {
        setIsOpen(false);
        navigate('/checkout');
    };
    return (_jsxs("div", { className: "relative", children: [_jsxs("button", { onClick: () => setIsOpen(!isOpen), className: "relative p-2 text-text-light hover:text-secondary transition-colors", "aria-label": "Shopping Cart", children: [_jsx(ShoppingCart, { className: "w-6 h-6" }), state.itemCount > 0 && (_jsx("span", { className: "absolute -top-1 -right-1 bg-secondary text-background text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium", children: state.itemCount > 99 ? '99+' : state.itemCount }))] }), isOpen && (_jsxs("div", { className: "absolute right-0 top-full mt-2 w-80 bg-background-light rounded-2xl shadow-2xl border border-border/30 z-50 glass-effect", children: [_jsx("div", { className: "p-4 border-b border-border/30", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("h3", { className: "text-lg font-medium text-text-light", children: "Shopping Cart" }), _jsx("button", { onClick: () => setIsOpen(false), className: "text-text-dark hover:text-text-light transition-colors", children: _jsx(X, { className: "w-5 h-5" }) })] }) }), _jsx("div", { className: "max-h-96 overflow-y-auto", children: state.items.length === 0 ? (_jsxs("div", { className: "p-6 text-center", children: [_jsx(ShoppingCart, { className: "w-12 h-12 text-text-dark mx-auto mb-3" }), _jsx("p", { className: "text-text-dark", children: "Your cart is empty" }), _jsx("p", { className: "text-text-dark text-sm", children: "Add some products to get started!" })] })) : (_jsx("div", { className: "p-4 space-y-3", children: state.items.map((item) => (_jsxs("div", { className: "flex items-center space-x-3 p-3 bg-background/30 rounded-xl", children: [_jsxs("div", { className: "flex-1 min-w-0", children: [_jsx("h4", { className: "text-sm font-medium text-text-light truncate", children: item.title }), _jsx("p", { className: "text-xs text-text-dark", children: item.format.toUpperCase() }), _jsx("p", { className: "text-sm text-secondary font-medium", children: formatPrice(item.price, item.currency) })] }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("button", { onClick: () => updateQuantity(item.id, item.quantity - 1), className: "p-1 text-text-dark hover:text-text-light transition-colors", "aria-label": "Decrease quantity", children: _jsx(Minus, { className: "w-4 h-4" }) }), _jsx("span", { className: "text-sm text-text-light min-w-[2rem] text-center", children: item.quantity }), _jsx("button", { onClick: () => updateQuantity(item.id, item.quantity + 1), className: "p-1 text-text-dark hover:text-text-light transition-colors", "aria-label": "Increase quantity", children: _jsx(Plus, { className: "w-4 h-4" }) }), _jsx("button", { onClick: () => removeItem(item.id), className: "p-1 text-error hover:text-error-dark transition-colors", "aria-label": "Remove item", children: _jsx(Trash2, { className: "w-4 h-4" }) })] })] }, item.id))) })) }), state.items.length > 0 && (_jsxs("div", { className: "p-4 border-t border-border/30", children: [_jsxs("div", { className: "flex items-center justify-between mb-4", children: [_jsx("span", { className: "text-text-light font-medium", children: "Total:" }), _jsx("span", { className: "text-xl text-secondary font-bold", children: formatPrice(state.total, 'USD') })] }), _jsxs("div", { className: "space-y-2", children: [_jsx("button", { onClick: handleCheckout, className: "w-full bg-secondary text-background py-3 px-4 rounded-xl font-medium hover:bg-secondary-dark transition-colors", children: "Proceed to Checkout" }), _jsx("button", { onClick: clearCart, className: "w-full bg-background/50 text-text-light py-2 px-4 rounded-xl font-medium hover:bg-background/70 transition-colors border border-border/30", children: "Clear Cart" })] })] }))] })), isOpen && (_jsx("div", { className: "fixed inset-0 z-40", onClick: () => setIsOpen(false) }))] }));
};
